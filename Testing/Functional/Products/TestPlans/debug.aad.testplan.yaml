ProductName: aad
TestPlan:     
  - PolicyId: MS.AAD.5.4v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.AAD.5.4v1 Non-Compliant - EnableGroupSpecificConsent is true
        Preconditions: 
          - Command: UpdateDirectorySettingByName
            Splat:
              DisplayName: Consent Policy Settings
              Updates:
                BodyParameter:
                  Values:
                    - Name: EnableGroupSpecificConsent
                      Value: 'true'
                    - Name: BlockUserConsentForRiskyApps
                      Value: 'false'  
                    - Name: EnableAdminConsentRequests
                      Value: 'false'
                    - Name: ConstrainGroupSpecificConsentToMembersOfGroupId
                      Value: ""  
        Postconditions: []
        ExpectedResult: false    
      - TestDescription: MS.AAD.5.4v1 Default
        Preconditions: 
          - Command: UpdateDirectorySettingByName
            Splat:
              DisplayName: Consent Policy Settings
              Updates:
                BodyParameter:
                  Values:
                    - Name: EnableGroupSpecificConsent
                      Value: 'false'
                    - Name: BlockUserConsentForRiskyApps
                      Value: 'false'  
                    - Name: EnableAdminConsentRequests
                      Value: 'false'
                    - Name: ConstrainGroupSpecificConsentToMembersOfGroupId
                      Value: ""  
        Postconditions: []
        ExpectedResult: true

ProductName: aad
TestPlan:     
  - PolicyId: MS.AAD.7.5v1
    TestDriver: RunCached
    ToDo: Change to RunScuba? Need better tests
    Tests:
      - TestDescription: MS.AAD.7.5v1 Null Start
        Preconditions:           
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Assignments[0].StartDateTime: null
        Postconditions: []
        ExpectedResult: false
  - PolicyId: MS.AAD.7.6v1
    TestDriver: RunCached
    Tests:
      - TestDescription: MS.AAD.7.6v1 Default
        Preconditions:  
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Rules[0].Id: Approval_EndUser_Assignment
                privileged_roles[0].Rules[0].AdditionalProperties.setting.isApprovalRequired: false
                privileged_roles[0].DisplayName: Not Global Administrator
        Postconditions: []
        ExpectedResult: false
  - PolicyId: MS.AAD.7.7v1
    TestDriver: RunCached
    ToDo: Changed to RunScuba
    Tests:
      - TestDescription: MS.AAD.7.7v1 Default
        Preconditions:  
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Rules[0].Id: Notification_Admin_Admin_Assignment
                privileged_roles[0].Rules[0].AdditionalProperties.notificationRecipients[0]: "user@somewhere.org"
                privileged_roles[0].DisplayName: Global Administrator
        Postconditions: []
        ExpectedResult: false
  - PolicyId: MS.AAD.7.8v1
    TestDriver: RunCached
    ToDo: Changed to RunScuba
    Tests:
      - TestDescription: MS.AAD.7.8v1 No notificationRecipients
        Preconditions:  
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Rules[0].Id: Notification_Admin_EndUser_Assignment
                privileged_roles[0].Rules[0].AdditionalProperties.notificationType: Email
                privileged_roles[0].Rules[0].AdditionalProperties:
                  notificationRecipients: []
                privileged_roles[0].DisplayName: Global Administrator
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.AAD.7.8v1 Default
        Preconditions:  
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Rules[0].Id: Notification_Admin_EndUser_Assignment
                privileged_roles[0].Rules[0].AdditionalProperties.notificationType: Email
                privileged_roles[0].Rules[0].AdditionalProperties:
                  notificationRecipients:
                    - 'someone@somewhere.org'
                privileged_roles[0].DisplayName: Global Administrator
        Postconditions: []
        ExpectedResult: true    
  - PolicyId: MS.AAD.7.9v1
    TestDriver: RunCached
    ToDo: Changed to RunScuba
    Tests:
      - TestDescription: MS.AAD.7.9v1 Default
        Preconditions:  
          - Command: UpdateProviderExport
            Splat:
              Updates:
                privileged_roles[0].Rules[0].Id: Notification_Admin_EndUser_Assignment
                privileged_roles[0].Rules[0].AdditionalProperties.notificatinType: Email
                privileged_roles[0].Rules[0].AdditionalProperties.notificationRecipients: []
                privileged_roles[0].DisplayName: Privileged Role Administrator
        Postconditions: []
        ExpectedResult: false
